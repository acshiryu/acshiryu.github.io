title: poj3233 又见矩阵，不过是等比吗？
toc: true
tags:
  - 分治
  - 数学
  - 矩阵
categories:
  - 算法竞赛
id: 1007
date: 2012-03-10 23:57:44
---

题目大意很明了，初看是像是就等比数列前n项和，但公比是一个矩阵，能用吗？

我不知道，因为如果是类似等比数列前n项和的好像关于矩阵除法比较难写，中间涉及到逆举证神马的，直接忽略

输入的数据第一行分别是n，k，m

代表矩阵的是n×n型，求前k项和，结果的每一项对m取模

然后就是一个n×n的矩阵。

我做这题时用的是类似二分的方法做的，仔细观察可以发现

Sk = A + A2 + A3 + … + Ak   

    =(1+Ak/2)*(A + A2 + A3 + … + Ak/2  )+{Ak}

    =(1+Ak/2)*(Sk/2 )+{Ak}

**当k为偶数时不要大括号里面的数**

故可以用这方法直接推出答案，中间要记得对数取模，以防超int，还要注意S1=A ；

然后就是写矩阵乘法与加法部分，可直接套模板

[code lang="cpp"]

[/code]